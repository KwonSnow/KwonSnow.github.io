---
title: "1D DFT practice"
date: 2020-07-19T08:08:50-04:00
category: DFT
tags:
  - DFT
  - Python
---

# 1D DFT code


1. grid 정의 in real space, Ng = the number of grid points in 1D
2. External potential, Vext 정의 from neuclues position
3. Guess the initial electron density
4. initialize the Hartree (Coulomb) potential (vhartree_g) and the exchange potential (vx_g) as 0 on all grid → 첫 SCF loop에서는 no vhartree_g and vx_g

SCF loop
1. effective potential, veff_g = vext_g + vhartree_g + vx_g   # for the first loop, vhartree_g and vx_g are zero.   # np.shape for all potential is (Ng,0)
2. Hamiltonian, H_gg = T_gg + np.diag(veff_g)    # np.diag: construct diagonal array to make np.shape(veff_g)=(Ng,Ng)
3. Solve Kohn-Sham equation: eps_n, psi_gn = np.linalg.eigh(H_gg)   __# grid points (Ng) 만큼의 states가 계산됨.__
  - eps_n = eigenvalues, psi_gn = Kohn-Sham orbitals
  - dimension: eps_n : (200,0), psi_gn = (200,200)
  - ith eigenvalue = eps_n[i], ith orbital = psi_gn[i]
4. 기존의 ρ_old와, 새로운 ρ_new = 2.0 * sum(ψ<sub>occupied</sub>^2) 간의 차이가 
5. density change integral의 convergence criteria (<1e-6) 를 만족하는지 확인: sum(|ρ_new(x) - ρ_old(x)|) * dx 
6. 전체 charge가 2 * Nn인지 확인
  sum(ρ_new(x)) * dx - 2 * Nn < 1e-14

\Desktop\Study\1D_DFT_code\1D_DFT.ipynb
http://dcwww.camd.dtu.dk/~askhl/files/python-dft-exercises.pdf
https://github.com/tamuhey/python_1d_dft
